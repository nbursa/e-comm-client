import{Q}from"./QImg-Bgk3Femz.js";import{S as G,aB as J,X as K,V as ee,W as te,Y as ae,r as n,l as v,e as oe,av as le,Z as k,_ as se,$ as p,aw as ne,a0 as s,aC as S,aa as ce,a1 as c,a6 as m,a3 as ie,a8 as B,ab as V,af as re,ah as b,a4 as ue,ag as de,a2 as me,aD as ve,aE as pe,ay as he}from"./index-BPO_bfT0.js";import{Q as ge}from"./QPage-DcIGDCGx.js";const fe={class:"q-mb-md q-mx-auto overflow-hidden",style:{"max-width":"1200px"}},we={class:"col-12 col-md-4 q-py-lg tw-transition tw-duration-200 tw-ease-in-out hover:tw-scale-105"},ye={class:"col-12 col-md-8 sm:tw-p-3 !tw-align-top",style:{display:"flex","flex-direction":"column","flex-grow":"0",height:"auto","min-height":"100%"}},xe={class:"text-caption q-mt-sm"},_e={class:"q-mt-sm text-bold price-text"},ke={class:"text-grey"},be={class:"text-positive q-ml-sm"},Pe={class:"row justify-center q-mt-xl"},Ce={class:"row justify-between items-center q-mb-md"},qe={class:"text-caption tw-font-black"},Ve=G({__name:"SingleProductPage",setup(Te){const{getVerticalScrollPosition:E}=he,L="https://e-comm-backend-16bba1769344.herokuapp.com",M=J(),X=K(),i=ee(),w=te(),{t:Y}=ae(),a=n({id:0,title:"",name:"",price:0,quantity:0,description:"",category:"",image:"",rating:{rate:0,count:0}}),z=n(!1),h=n(!1),P=n(""),o=n(!1),r=n(!1),g=n(0),f=n(0),u=n(0),d=n(0),C=v(()=>i.dark.isActive?"white":"black"),q=v(()=>i.dark.isActive?"black":"white"),$e=v(()=>w.totalItems),Ie=v(()=>w.totalPrice),T=e=>e,U=v(()=>({transform:`translate(${u.value}px, ${d.value}px) scale(${o.value?2:1})`})),y=e=>`$${e.toFixed(2)}`,Z=()=>{window.scrollTo({top:0,behavior:"smooth"})},j=e=>{w.addItem({...e,quantity:1}),Z(),i.notify({color:"positive",message:Y("singleProduct.itemAdded"),icon:"check_circle"})},A=e=>{P.value=e,h.value=!0,o.value=!1},$=()=>{console.log("toggleZoom"),o.value?D():o.value=!0},D=()=>{o.value=!1,u.value=0,d.value=0},N=e=>{if(!o.value){$();return}r.value=!0,g.value=e.clientX-u.value,f.value=e.clientY-d.value},F=e=>{r.value=!0;const t=e.touches[0];t&&(g.value=t.clientX-u.value,f.value=t.clientY-d.value,document.addEventListener("touchmove",x),document.addEventListener("touchend",_))},x=e=>{if(!o.value||!r.value)return;const t=e.touches[0];t&&(u.value=(t.clientX-g.value)*-1,d.value=(t.clientY-f.value)*-1)},O=e=>{!o.value||!r.value||(u.value=(e.clientX-g.value)*-1,d.value=(e.clientY-f.value)*-1)},R=()=>{o.value&&(r.value=!1)},_=()=>{if(!o.value){o.value=!0;return}r.value=!1,document.removeEventListener("touchmove",x),document.removeEventListener("touchend",_)},H=()=>{X.push("/products")},W=async()=>{const{slug:e}=M.params;i.loading.show();try{const l=await(await fetch(`${L}/products/${e}`)).json();a.value={id:l.id,name:l.name,title:l.title,price:l.price,description:l.description,image:l.image,category:l.category,discount:Math.random()>.5,discountedPrice:l.price*(Math.random()>.5?.9:1),quantity:0,rating:{rate:0,count:0}}}catch{i.notify({color:"negative",message:"Failed to fetch product details.",icon:"error"})}finally{i.loading.hide()}},I=()=>{const e=E(window);z.value=e>0};return oe(()=>{W(),window.addEventListener("scroll",I)}),le(()=>{window.removeEventListener("scroll",I)}),(e,t)=>(k(),se(ge,{padding:""},{default:p(()=>[ne("",!0),s("div",fe,[s("div",{class:S(["row items-stretch full-height",{"col-reverse-md":ce(i).screen.md}])},[s("div",we,[c(Q,{src:T(a.value.image),alt:a.value.name,fit:"contain",class:"cursor-pointer full-width full-height",onClick:t[0]||(t[0]=l=>A(a.value.image))},null,8,["src","alt"])]),s("div",ye,[c(ie,{class:"q-pa-sm !tw-pb-0",style:{flex:"1",display:"flex","flex-direction":"column",height:"100%"}},{default:p(()=>[s("h5",null,m(a.value.name||a.value.title),1),s("div",xe,m(a.value.description),1)]),_:1}),c(de,{align:"right",class:"row justify-between items-end !tw-pt-0"},{default:p(()=>[s("div",_e,[a.value.discount?(k(),B(V,{key:0},[s("s",ke,m(y(a.value.price)),1),s("span",be,m(y(a.value.discountedPrice||a.value.price)),1)],64)):(k(),B(V,{key:1},[re(m(y(a.value.price)),1)],64))]),c(b,{color:C.value,"text-color":q.value,label:e.$t("singleProduct.addToCart"),class:"q-px-md full-width",onClick:t[1]||(t[1]=ue(l=>j(a.value),["stop"]))},null,8,["color","text-color","label"])]),_:1})])],2)]),s("div",Pe,[c(b,{color:C.value,"text-color":q.value,label:e.$t("singleProduct.backToProducts"),onClick:H},null,8,["color","text-color","label"])]),c(pe,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=l=>h.value=l),maximized:""},{default:p(()=>[c(me,{class:"q-pa-md",style:{"max-width":"90vw","max-height":"90vh",overflow:"hidden"}},{default:p(()=>[s("div",Ce,[s("div",qe,m(a.value.name),1),c(b,{flat:"",dense:"",round:"",icon:"close",onClick:t[2]||(t[2]=l=>h.value=!1)})]),c(Q,{src:T(a.value.image),alt:P.value,class:S(["zoomable-image tw-cursor-pointer",{"zoom-in":o.value,"zoom-out":!o.value}]),style:ve([{"max-width":"100%","max-height":"100%"},U.value]),fit:"contain",onClick:$,onMouseenter:N,onMousemove:O,onMouseleave:R,onTouchstart:F,onTouchmove:x,onTouchend:_},null,8,["src","alt","class","style"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Ve as default};

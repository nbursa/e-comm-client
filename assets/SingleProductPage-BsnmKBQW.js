import{Q as V,f as u}from"./currency-BG3kQ6B7.js";import{U as E,I as U,aG as D,ad as F,ab as M,ac as R,ae as z,aH as G,r as H,l as x,e as L,V as m,W as O,X as p,_ as o,a6 as W,a0 as n,Y as r,$ as l,aj as g,Z as X,a1 as b,a3 as k,a5 as q,ak as Y,a4 as Z}from"./index-DYKivRXB.js";import{Q as J}from"./QPage-D51xbe9f.js";import{u as K}from"./products-MNvJRDtg.js";import"./rates-D9XargGH.js";const tt={class:"q-mb-md q-mx-auto overflow-hidden",style:{"max-width":"1200px"}},et={class:"col-12 col-md-4 q-py-lg tw-transition tw-duration-200 tw-ease-in-out hover:tw-scale-105"},at={class:"col-12 col-md-8 sm:tw-p-3 !tw-align-top",style:{display:"flex","flex-direction":"column","flex-grow":"0",height:"auto","min-height":"100%"}},st={class:"tw-flex tw-justify-start tw-gap-2"},ot={class:"tw-text-sm tw-mb-2"},it={class:"tw-text-xs"},ct={class:"text-caption q-mt-sm"},lt={class:"q-mt-sm text-bold price-text"},rt={class:"text-grey"},nt={class:"text-positive q-ml-sm"},dt={class:"row justify-center q-mt-xl"},ft=E({__name:"SingleProductPage",setup(ut){const C=U("scrollToTop"),P="https://e-comm-backend-16bba1769344.herokuapp.com/api".replace(/\/$/,""),I=D(),v=F(),i=M(),$=R(),{t:Q}=z(),h=K(),S=G(),t=H({id:0,title:"",name:"",price:0,quantity:0,description:"",category:"",image:"",rating:{rate:0,count:0}}),f=x(()=>i.dark.isActive?"white":"black"),w=x(()=>i.dark.isActive?"black":"white"),d=s=>s||"/assets/placeholder.webp",T=s=>{const a=[{src:d(s),name:t.value.name||t.value.title||""}];if(t.value.additionalImages?.length){const c=t.value.additionalImages.map(y=>({src:d(y),name:t.value.name||t.value.title||""}));a.push(...c)}S.openPreview(a)},j=s=>{$.addItem({...s,quantity:1}),C(),i.notify({color:"positive",position:"top",timeout:1e3,message:Q("singleProduct.itemAdded"),icon:"check_circle"})},B=()=>{v.push("/products")},A=async()=>{const{slug:s}=I.params;i.loading.show();try{const a=h.getCache("viewed");if(a){const _=a.products.find(N=>N.id===Number(s));if(_){t.value=_;return}}const c=await fetch(`${P}/products/${s}`);if(!c.ok)throw new Error(`API returned ${c.status}`);const e=(await c.json()).data;t.value={id:e.id,name:e.name,title:e.title||e.name,price:Number(e.price),description:e.description,image:e.image,additionalImages:e.additionalImages||[],category:e.category,discount:e.discount||0,discountedPrice:e.price-e.price*(e.discount||10)/100,quantity:e.quantity||0,rating:e.rating||{rate:0,count:0}},h.setCache([t.value],"viewed")}catch(a){console.warn("Error fetching product:",a),i.notify({color:"negative",position:"top",timeout:1e3,message:"Failed to fetch product details.",icon:"error"}),t.value.id||v.push("/products")}finally{i.loading.hide()}};return L(async()=>{await A()}),(s,a)=>(m(),O(J,{padding:"",class:"!tw-pb-16 md:tw-pb-24 !tw-pt-4"},{default:p(()=>[o("div",tt,[o("div",{class:W(["row items-stretch full-height",{"col-reverse-md":n(i).screen.md}])},[o("div",et,[r(V,{src:d(t.value.image),alt:t.value.name,fit:"contain",class:"cursor-pointer full-width full-height",onClick:a[0]||(a[0]=c=>T(t.value.image))},null,8,["src","alt"])]),o("div",at,[r(X,{class:"q-pa-sm !tw-pb-0",style:{flex:"1",display:"flex","flex-direction":"column",height:"100%"}},{default:p(()=>[o("h5",st,[o("span",null,l(t.value.name||t.value.title),1),o("span",ot,[g("("+l(t.value.quantity)+" ",1),o("span",it,l(s.$t("singleProduct.quantity")),1),a[2]||(a[2]=g(")"))])]),o("div",ct,l(t.value.description),1)]),_:1}),r(Z,{align:"right",class:"row justify-between items-end !tw-pt-0"},{default:p(()=>[o("div",lt,[t.value.discount?(m(),b(k,{key:0},[o("s",rt,l(n(u)(t.value.price)),1),o("span",nt,l(n(u)(t.value.discountedPrice||t.value.price)),1)],64)):(m(),b(k,{key:1},[g(l(n(u)(t.value.price)),1)],64))]),r(q,{color:f.value,"text-color":w.value,label:s.$t("singleProduct.addToCart"),class:"!tw-p-4 full-width",onClick:a[1]||(a[1]=Y(c=>j(t.value),["stop"]))},null,8,["color","text-color","label"])]),_:1})])],2)]),o("div",dt,[r(q,{color:f.value,"text-color":w.value,label:s.$t("singleProduct.backToProducts"),onClick:B},null,8,["color","text-color","label"])])]),_:1}))}});export{ft as default};

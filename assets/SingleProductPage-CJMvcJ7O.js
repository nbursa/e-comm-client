import{Q as V,f as _}from"./currencyUtils-BHk0B_6A.js";import{S as K,I as ee,aF as te,ac as ae,aa as oe,ab as se,ad as le,r as n,l as b,e as ne,U as k,V as ie,W as p,Z as o,a5 as X,$ as w,X as i,_ as r,ai as P,Y as ce,a0 as Y,a2 as z,a4 as C,aj as re,a3 as ue,a6 as de,aG as ve,a7 as me}from"./index-F2iZL-ou.js";import{Q as pe}from"./QPage-DgUtPfJH.js";import{u as fe}from"./products-hpXCToPi.js";import"./rates-BU8d3Kor.js";const he={class:"q-mb-md q-mx-auto overflow-hidden",style:{"max-width":"1200px"}},ge={class:"col-12 col-md-4 q-py-lg tw-transition tw-duration-200 tw-ease-in-out hover:tw-scale-105"},we={class:"col-12 col-md-8 sm:tw-p-3 !tw-align-top",style:{display:"flex","flex-direction":"column","flex-grow":"0",height:"auto","min-height":"100%"}},ye={class:"tw-flex tw-justify-start tw-gap-2"},xe={class:"tw-text-sm tw-mb-2"},_e={class:"tw-text-xs"},be={class:"text-caption q-mt-sm"},ke={class:"q-mt-sm text-bold price-text"},Pe={class:"text-grey"},Ce={class:"text-positive q-ml-sm"},qe={class:"row justify-center q-mt-xl"},Te={class:"row justify-between items-center q-mb-md"},$e={class:"text-caption tw-font-black"},Xe=K({__name:"SingleProductPage",setup(Qe){const B=ee("scrollToTop"),A=te(),q=ae(),u=oe(),L=se(),{t:M}=le(),T=fe(),a=n({id:0,title:"",name:"",price:0,quantity:0,description:"",category:"",image:"",rating:{rate:0,count:0}}),f=n(!1),$=n(""),s=n(!1),d=n(!1),h=n(0),g=n(0),v=n(0),m=n(0),Q=b(()=>u.dark.isActive?"white":"black"),I=b(()=>u.dark.isActive?"black":"white"),S=t=>t,N=b(()=>({transform:`translate(${v.value}px, ${m.value}px) scale(${s.value?2:1})`})),U=t=>{L.addItem({...t,quantity:1}),B(),u.notify({color:"positive",position:"top",timeout:1e3,message:M("singleProduct.itemAdded"),icon:"check_circle"})},Z=t=>{$.value=t,f.value=!0,s.value=!1},j=()=>{s.value?D():s.value=!0},D=()=>{s.value=!1,v.value=0,m.value=0},F=t=>{if(!s.value){j();return}d.value=!0,h.value=t.clientX-v.value,g.value=t.clientY-m.value},O=t=>{d.value=!0;const e=t.touches[0];e&&(h.value=e.clientX-v.value,g.value=e.clientY-m.value,document.addEventListener("touchmove",y),document.addEventListener("touchend",x))},y=t=>{if(!s.value||!d.value)return;const e=t.touches[0];e&&(v.value=(e.clientX-h.value)*-1,m.value=(e.clientY-g.value)*-1)},R=t=>{!s.value||!d.value||(v.value=(t.clientX-h.value)*-1,m.value=(t.clientY-g.value)*-1)},G=()=>{s.value&&(d.value=!1)},x=()=>{if(!s.value){s.value=!0;return}d.value=!1,document.removeEventListener("touchmove",y),document.removeEventListener("touchend",x)},H=()=>{q.push("/products")},W=async()=>{const{slug:t}=A.params;u.loading.show();try{const e=T.getCache("viewed");if(e){const E=e.products.find(J=>J.id===Number(t));if(E){a.value=E;return}}const c=await fetch(`https://e-comm-backend-16bba1769344.herokuapp.com/products/${t}`);if(!c.ok)throw new Error(`API returned ${c.status}`);const l=await c.json();a.value={id:l.id,name:l.name,title:l.title,price:l.price,description:l.description,image:l.image,category:l.category,discount:l.discount||0,discountedPrice:l.price-l.price*(l.discount||10)/100,quantity:l.quantity,rating:l.rating},T.setCache([a.value],"viewed")}catch(e){console.warn("Error fetching product:",e),u.notify({color:"negative",position:"top",timeout:1e3,message:"Failed to fetch product details.",icon:"error"}),a.value.id||q.push("/products")}finally{u.loading.hide()}};return ne(()=>{W()}),(t,e)=>(k(),ie(pe,{padding:""},{default:p(()=>[o("div",he,[o("div",{class:X(["row items-stretch full-height",{"col-reverse-md":w(u).screen.md}])},[o("div",ge,[i(V,{src:S(a.value.image),alt:a.value.name,fit:"contain",class:"cursor-pointer full-width full-height",onClick:e[0]||(e[0]=c=>Z(a.value.image))},null,8,["src","alt"])]),o("div",we,[i(ce,{class:"q-pa-sm !tw-pb-0",style:{flex:"1",display:"flex","flex-direction":"column",height:"100%"}},{default:p(()=>[o("h5",ye,[o("span",null,r(a.value.name||a.value.title),1),o("span",xe,[P("("+r(a.value.quantity)+" ",1),o("span",_e,r(t.$t("singleProduct.quantity")),1),e[4]||(e[4]=P(")"))])]),o("div",be,r(a.value.description),1)]),_:1}),i(ue,{align:"right",class:"row justify-between items-end !tw-pt-0"},{default:p(()=>[o("div",ke,[a.value.discount?(k(),Y(z,{key:0},[o("s",Pe,r(w(_)(a.value.price)),1),o("span",Ce,r(w(_)(a.value.discountedPrice||a.value.price)),1)],64)):(k(),Y(z,{key:1},[P(r(w(_)(a.value.price)),1)],64))]),i(C,{color:Q.value,"text-color":I.value,label:t.$t("singleProduct.addToCart"),class:"!tw-p-4 full-width",onClick:e[1]||(e[1]=re(c=>U(a.value),["stop"]))},null,8,["color","text-color","label"])]),_:1})])],2)]),o("div",qe,[i(C,{color:Q.value,"text-color":I.value,label:t.$t("singleProduct.backToProducts"),onClick:H},null,8,["color","text-color","label"])]),i(me,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=c=>f.value=c),maximized:""},{default:p(()=>[i(de,{class:"q-pa-md overlay",style:{width:"100vw",height:"100vh",overflow:"hidden"}},{default:p(()=>[o("div",Te,[o("div",$e,r(a.value.name),1),i(C,{flat:"",dense:"",round:"",icon:"close",onClick:e[2]||(e[2]=c=>f.value=!1)})]),i(V,{src:S(a.value.image),alt:$.value,class:X(["zoomable-image tw-cursor-pointer",{"zoom-in":s.value,"zoom-out":!s.value}]),style:ve([{"max-width":"100%","max-height":"100%"},N.value]),fit:"contain",onClick:j,onMouseenter:F,onMousemove:R,onMouseleave:G,onTouchstart:O,onTouchmove:y,onTouchend:x},null,8,["src","alt","class","style"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Xe as default};

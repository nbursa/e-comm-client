import{aM as c,s as r}from"./index-9txCErRn.js";const m=c("products",()=>{const i="products",a=()=>{const e={all:[],viewed:[],categories:[],product_categories:{},timestamp:Date.now(),version:"1.0",expiration:3e5},t=r.get(i);return t||e};return{setCache:(e,t="all")=>{const s=a();if(t==="all")s.all=e;else if(t==="viewed"){const o=e[0];o&&(s.viewed=[o,...(s.viewed||[]).filter(n=>n.id!==o.id)].slice(0,10))}else{s.product_categories=s.product_categories||{};const o=t.startsWith("product_")?t:`product_${t.toLowerCase()}`;s.product_categories[o]=e}s.timestamp=Date.now(),r.set(i,s,{expiration:3e5,version:"1.0"})},getCache:(e="all")=>{const t=a();let s=[];return e==="all"?s=t.all||[]:e==="viewed"?s=t.viewed||[]:e.startsWith("product_")&&(s=t.product_categories?.[e]||[]),s.length?{products:s,timestamp:t.timestamp,category:e}:null},isCacheValid:(e="all")=>{const t=a(),s=t.timestamp,o=Date.now();return console.log("Cache check:",{category:e,timestamp:s,age:o-s,expiration:3e5,isValid:o-s<3e5}),e==="all"?!!t.all?.length&&Date.now()-s<3e5:e==="viewed"?!!t.viewed?.length&&Date.now()-s<3e5:e.startsWith("product_")?!!t.product_categories?.[e]?.length&&Date.now()-s<3e5:!1},setCategoryCache:e=>{const t=a();t.categories=e,t.timestamp=Date.now(),r.set(i,t,{expiration:3e5,version:"1.0"})},getCategoryCache:()=>{const e=a();return e.categories?.length?{categories:e.categories,timestamp:e.timestamp}:null},isCategoryCacheValid:()=>!r.isExpired(i)}});export{m as u};

import{Q as A,f as u}from"./currencyUtils-Due7Wa4v.js";import{U as N,I as V,aG as E,ad as D,ab as F,ac as M,ae as R,aH as U,r as z,l as _,e as G,V as m,W as H,X as p,_ as o,a6 as L,a0 as r,Y as n,$ as l,aj as g,Z as O,a1 as x,a3 as b,a5 as k,ak as W,a4 as X}from"./index-CQF2o2kt.js";import{Q as Y}from"./QPage-DsNEsvRT.js";import{u as Z}from"./products-C27Cvnsv.js";import"./rates-CXyrA5_8.js";const J={class:"q-mb-md q-mx-auto overflow-hidden",style:{"max-width":"1200px"}},K={class:"col-12 col-md-4 q-py-lg tw-transition tw-duration-200 tw-ease-in-out hover:tw-scale-105"},tt={class:"col-12 col-md-8 sm:tw-p-3 !tw-align-top",style:{display:"flex","flex-direction":"column","flex-grow":"0",height:"auto","min-height":"100%"}},et={class:"tw-flex tw-justify-start tw-gap-2"},at={class:"tw-text-sm tw-mb-2"},ot={class:"tw-text-xs"},st={class:"text-caption q-mt-sm"},it={class:"q-mt-sm text-bold price-text"},ct={class:"text-grey"},lt={class:"text-positive q-ml-sm"},nt={class:"row justify-center q-mt-xl"},vt=N({__name:"SingleProductPage",setup(rt){const P=V("scrollToTop"),q=E(),v=D(),i=F(),C=M(),{t:I}=R(),h=Z(),$=U(),t=z({id:0,title:"",name:"",price:0,quantity:0,description:"",category:"",image:"",rating:{rate:0,count:0}}),f=_(()=>i.dark.isActive?"white":"black"),w=_(()=>i.dark.isActive?"black":"white"),d=s=>s,Q=s=>{const a=[{src:d(s),name:t.value.name||t.value.title||""}];if(t.value.additionalImages?.length){const c=t.value.additionalImages.map(e=>({src:d(e),name:t.value.name||t.value.title||""}));a.push(...c)}$.openPreview(a)},S=s=>{C.addItem({...s,quantity:1}),P(),i.notify({color:"positive",position:"top",timeout:1e3,message:I("singleProduct.itemAdded"),icon:"check_circle"})},T=()=>{v.push("/products")},j=async()=>{const{slug:s}=q.params;i.loading.show();try{const a=h.getCache("viewed");if(a){const y=a.products.find(B=>B.id===Number(s));if(y){t.value=y;return}}const c=await fetch(`https://e-comm-backend-16bba1769344.herokuapp.com/products/${s}`);if(!c.ok)throw new Error(`API returned ${c.status}`);const e=await c.json();t.value={id:e.id,name:e.name,title:e.title,price:e.price,description:e.description,image:e.image,additionalImages:e.additionalImages,category:e.category,discount:e.discount||0,discountedPrice:e.price-e.price*(e.discount||10)/100,quantity:e.quantity,rating:e.rating},h.setCache([t.value],"viewed")}catch(a){console.warn("Error fetching product:",a),i.notify({color:"negative",position:"top",timeout:1e3,message:"Failed to fetch product details.",icon:"error"}),t.value.id||v.push("/products")}finally{i.loading.hide()}};return G(()=>{j()}),(s,a)=>(m(),H(Y,{padding:"",class:"!tw-pb-16 md:tw-pb-24 !tw-pt-4"},{default:p(()=>[o("div",J,[o("div",{class:L(["row items-stretch full-height",{"col-reverse-md":r(i).screen.md}])},[o("div",K,[n(A,{src:d(t.value.image),alt:t.value.name,fit:"contain",class:"cursor-pointer full-width full-height",onClick:a[0]||(a[0]=c=>Q(t.value.image))},null,8,["src","alt"])]),o("div",tt,[n(O,{class:"q-pa-sm !tw-pb-0",style:{flex:"1",display:"flex","flex-direction":"column",height:"100%"}},{default:p(()=>[o("h5",et,[o("span",null,l(t.value.name||t.value.title),1),o("span",at,[g("("+l(t.value.quantity)+" ",1),o("span",ot,l(s.$t("singleProduct.quantity")),1),a[2]||(a[2]=g(")"))])]),o("div",st,l(t.value.description),1)]),_:1}),n(X,{align:"right",class:"row justify-between items-end !tw-pt-0"},{default:p(()=>[o("div",it,[t.value.discount?(m(),x(b,{key:0},[o("s",ct,l(r(u)(t.value.price)),1),o("span",lt,l(r(u)(t.value.discountedPrice||t.value.price)),1)],64)):(m(),x(b,{key:1},[g(l(r(u)(t.value.price)),1)],64))]),n(k,{color:f.value,"text-color":w.value,label:s.$t("singleProduct.addToCart"),class:"!tw-p-4 full-width",onClick:a[1]||(a[1]=W(c=>S(t.value),["stop"]))},null,8,["color","text-color","label"])]),_:1})])],2)]),o("div",nt,[n(k,{color:f.value,"text-color":w.value,label:s.$t("singleProduct.backToProducts"),onClick:T},null,8,["color","text-color","label"])])]),_:1}))}});export{vt as default};

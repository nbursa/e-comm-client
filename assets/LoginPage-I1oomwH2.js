import{at as L,d as M,a as T,e as q,c as B,f as I,r as i,B as N,j as r,k as u,w as c,l as m,m as f,t as g,n as a,p as j,q as k,v as d,x as C,y as F,z as O,Q as b,A as z,au as D,av as U,aw as $}from"./index-C0JJa2YO.js";import{Q as G}from"./QForm-CKSKV2hQ.js";import{Q as J}from"./QPage-BAchSC7v.js";const{Axios:re,AxiosError:K,CanceledError:ne,isCancel:ie,CancelToken:ue,VERSION:ce,all:de,Cancel:we,isAxiosError:me,spread:fe,toFormData:pe,AxiosHeaders:ge,HttpStatusCode:ve,formToJSON:ye,getAdapter:xe,mergeConfig:_e}=L,W={class:"tw-w-full sm:tw-max-w-72 tw-mx-auto"},X={class:"tw-text-3xl tw-text-center tw-mb-8 tw-font-semibold tw-font-serif"},Y={class:"tw-w-full tw-flex tw-justify-center tw-items-center"},Z={key:2,class:"tw-text-red-500 tw-mb-4"},ee={class:"tw-flex tw-flex-col tw-gap-2"},te={class:"tw-flex tw-items-center tw-justify-center"},be=M({__name:"LoginPage",setup(se){const R=T(),{t}=q(),v=B(),y=I(),l=i(""),o=i(""),n=i(!1),A=i(""),p=i(!1),w=i(null),E=N(()=>l.value&&h(l.value)===!0&&o.value&&x(o.value)===!0),Q=()=>{y.push(D)},V=()=>{y.push(U)},S=()=>{p.value=!p.value},H=async()=>{if(w.value=null,!l.value||!o.value){v.notify({type:"negative",message:t("errors.loginRequired"),position:"top",timeout:5e3,icon:"error"}),w.value=t("errors.loginRequired");return}try{const e=await R.login(l.value,o.value);e&&(v.notify({type:"positive",message:e,position:"top",timeout:5e3,icon:"check"}),l.value="",o.value="",A.value=e,n.value=!0,await y.push($))}catch(e){let s=t("login.loginFailed");e instanceof K?s=e.response?.data?.error||e.message||s:e instanceof Error&&(s=e.message||s),w.value=s,v.notify({type:"negative",message:s,position:"top",timeout:5e3,icon:"error"})}},x=e=>!!e||t("errors.validation.required"),h=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?!0:t("errors.validation.invalidEmail"),P=e=>e.length<6?t("errors.validation.passwordMinLength",{minLength:6}):!0;return(e,s)=>(r(),u(J,{padding:"",class:"!tw-pb-16 !tw-px-3 tw-flex tw-justify-center tw-items-center"},{default:c(()=>[m("div",W,[f(z,{flat:"",bordered:"",class:"!tw-w-full !tw-max-w-54 tw-p-4 !tw-bg-transparent"},{default:c(()=>[m("h4",X,g(a(t)("login.title")),1),f(G,{class:"!tw-w-full",onSubmit:j(H,["prevent"])},{default:c(()=>[n.value?(r(),u(k,{key:0},{default:c(()=>[m("div",Y,g(a(t)("login.successMessage")),1)]),_:1})):d("",!0),n.value?d("",!0):(r(),u(k,{key:1,class:"tw-flex tw-flex-col tw-gap-4 tw-w-full !tw-p-0 tw-mb-4"},{default:c(()=>[f(C,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=_=>l.value=_),label:a(t)("login.email"),type:"email",dense:"","lazy-rules":"",rules:[x,h],class:"tw-w-full"},null,8,["modelValue","label","rules"]),f(C,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=_=>o.value=_),type:p.value?"text":"password",label:a(t)("login.password"),dense:"","lazy-rules":"",rules:[x,P],class:"tw-w-full"},{append:c(()=>[f(F,{name:p.value?"visibility_off":"visibility",onClick:S},null,8,["name"])]),_:1},8,["modelValue","type","label","rules"])]),_:1})),w.value?(r(),O("div",Z,g(w.value),1)):d("",!0),m("div",ee,[n.value?d("",!0):(r(),u(b,{key:0,type:"submit",disabled:!E.value,label:a(t)("login.login"),class:"!tw-w-full !tw-py-2.5"},null,8,["disabled","label"])),m("div",te,g(a(t)("login.or")),1),n.value?d("",!0):(r(),u(b,{key:1,secondary:"",label:a(t)("login.createAccount"),class:"!tw-w-full !tw-py-2.5",onClick:V},null,8,["label"])),n.value?(r(),u(b,{key:2,secondary:"",label:a(t)("login.goHome"),class:"!tw-w-full !tw-py-2.5",onClick:Q},null,8,["label"])):d("",!0)])]),_:1})]),_:1})])]),_:1}))}});export{be as default};

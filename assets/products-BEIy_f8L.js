import{aL as c,aH as r}from"./index-DxMxoTY1.js";const m=c("products",()=>{const i="products",a=()=>{const e={all:[],viewed:[],categories:[],product_categories:{},timestamp:Date.now(),version:"1.0",expiration:3e5},t=r.get(i);return t||e};return{setCache:(e,t="all")=>{const o=a();if(t==="all")o.all=e;else if(t==="viewed"){const s=e[0];s&&(o.viewed=[s,...(o.viewed||[]).filter(n=>n.id!==s.id)].slice(0,10))}else{o.product_categories=o.product_categories||{};const s=t.startsWith("product_")?t:`product_${t.toLowerCase()}`;o.product_categories[s]=e}o.timestamp=Date.now(),r.set(i,o,{expiration:3e5,version:"1.0"})},getCache:(e="all")=>{const t=a();let o=[];return e==="all"?o=t.all||[]:e==="viewed"?o=t.viewed||[]:e.startsWith("product_")&&(o=t.product_categories?.[e]||[]),o.length?{products:o,timestamp:t.timestamp,category:e}:null},isCacheValid:(e="all")=>{const t=a(),o=t.timestamp,s=Date.now();return console.log("Cache check:",{category:e,timestamp:o,age:s-o,expiration:3e5,isValid:s-o<3e5}),e==="all"?!!t.all?.length&&Date.now()-o<3e5:e==="viewed"?!!t.viewed?.length&&Date.now()-o<3e5:e.startsWith("product_")?!!t.product_categories?.[e]?.length&&Date.now()-o<3e5:!1},setCategoryCache:e=>{const t=a();t.categories=e,t.timestamp=Date.now(),r.set(i,t,{expiration:3e5,version:"1.0"})},getCategoryCache:()=>{const e=a();return e.categories?.length?{categories:e.categories,timestamp:e.timestamp}:null},isCategoryCacheValid:()=>!r.isExpired(i)}});export{m as u};

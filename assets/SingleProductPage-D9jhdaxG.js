import{Q as V,f as k}from"./currencyUtils-BcENtWex.js";import{S as K,aC as ee,X as te,V as ae,W as oe,Y as se,r as n,l as v,e as le,ax as ne,Z as b,_ as ie,$ as p,ab as ce,a0 as s,aD as B,af as w,a1 as i,aa as c,a9 as P,a3 as re,ac as E,ag as z,aj as q,a4 as ue,ai as de,a2 as me,aE as ve,aF as pe,az as ge}from"./index-uJpT7p7q.js";import{Q as fe}from"./QPage-DDDSQv2X.js";import"./rates-DzECmSwm.js";const he={class:"q-mb-md q-mx-auto overflow-hidden",style:{"max-width":"1200px"}},we={class:"col-12 col-md-4 q-py-lg tw-transition tw-duration-200 tw-ease-in-out hover:tw-scale-105"},ye={class:"col-12 col-md-8 sm:tw-p-3 !tw-align-top",style:{display:"flex","flex-direction":"column","flex-grow":"0",height:"auto","min-height":"100%"}},xe={class:"tw-flex tw-justify-start tw-gap-2"},_e={class:"tw-text-sm tw-mb-2"},ke={class:"tw-text-xs"},be={class:"text-caption q-mt-sm"},Pe={class:"q-mt-sm text-bold price-text"},qe={class:"text-grey"},Ce={class:"text-positive q-ml-sm"},Te={class:"row justify-center q-mt-xl"},$e={class:"row justify-between items-center q-mb-md"},Ie={class:"text-caption tw-font-black"},Xe=K({__name:"SingleProductPage",setup(Qe){const{getVerticalScrollPosition:L}=ge,X="https://e-comm-backend-16bba1769344.herokuapp.com",Y=ee(),j=te(),r=ae(),y=oe(),{t:M}=se(),o=n({id:0,title:"",name:"",price:0,quantity:0,description:"",category:"",image:"",rating:{rate:0,count:0}}),U=n(!1),g=n(!1),C=n(""),l=n(!1),u=n(!1),f=n(0),h=n(0),d=n(0),m=n(0),T=v(()=>r.dark.isActive?"white":"black"),$=v(()=>r.dark.isActive?"black":"white"),Se=v(()=>y.totalItems),Ve=v(()=>y.totalPrice),I=e=>e,Z=v(()=>({transform:`translate(${d.value}px, ${m.value}px) scale(${l.value?2:1})`})),A=()=>{window.scrollTo({top:0,behavior:"smooth"})},D=e=>{y.addItem({...e,quantity:1}),A(),r.notify({color:"positive",message:M("singleProduct.itemAdded"),icon:"check_circle"})},N=e=>{C.value=e,g.value=!0,l.value=!1},Q=()=>{console.log("toggleZoom"),l.value?F():l.value=!0},F=()=>{l.value=!1,d.value=0,m.value=0},O=e=>{if(!l.value){Q();return}u.value=!0,f.value=e.clientX-d.value,h.value=e.clientY-m.value},R=e=>{u.value=!0;const t=e.touches[0];t&&(f.value=t.clientX-d.value,h.value=t.clientY-m.value,document.addEventListener("touchmove",x),document.addEventListener("touchend",_))},x=e=>{if(!l.value||!u.value)return;const t=e.touches[0];t&&(d.value=(t.clientX-f.value)*-1,m.value=(t.clientY-h.value)*-1)},H=e=>{!l.value||!u.value||(d.value=(e.clientX-f.value)*-1,m.value=(e.clientY-h.value)*-1)},W=()=>{l.value&&(u.value=!1)},_=()=>{if(!l.value){l.value=!0;return}u.value=!1,document.removeEventListener("touchmove",x),document.removeEventListener("touchend",_)},G=()=>{j.push("/products")},J=async()=>{const{slug:e}=Y.params;r.loading.show();try{const a=await(await fetch(`${X}/products/${e}`)).json();o.value={id:a.id,name:a.name,title:a.title,price:a.price,description:a.description,image:a.image,category:a.category,discount:a.discount||0,discountedPrice:a.price-a.price*(a.discount||10)/100,quantity:a.quantity,rating:a.rating}}catch{r.notify({color:"negative",message:"Failed to fetch product details.",icon:"error"})}finally{r.loading.hide()}},S=()=>{const e=L(window);U.value=e>0};return le(()=>{J(),window.addEventListener("scroll",S)}),ne(()=>{window.removeEventListener("scroll",S)}),(e,t)=>(b(),ie(fe,{padding:""},{default:p(()=>[ce("",!0),s("div",he,[s("div",{class:B(["row items-stretch full-height",{"col-reverse-md":w(r).screen.md}])},[s("div",we,[i(V,{src:I(o.value.image),alt:o.value.name,fit:"contain",class:"cursor-pointer full-width full-height",onClick:t[0]||(t[0]=a=>N(o.value.image))},null,8,["src","alt"])]),s("div",ye,[i(re,{class:"q-pa-sm !tw-pb-0",style:{flex:"1",display:"flex","flex-direction":"column",height:"100%"}},{default:p(()=>[s("h5",xe,[s("span",null,c(o.value.name||o.value.title),1),s("span",_e,[P("("+c(o.value.quantity)+" ",1),s("span",ke,c(e.$t("singleProduct.quantity")),1),t[4]||(t[4]=P(")"))])]),s("div",be,c(o.value.description),1)]),_:1}),i(de,{align:"right",class:"row justify-between items-end !tw-pt-0"},{default:p(()=>[s("div",Pe,[o.value.discount?(b(),E(z,{key:0},[s("s",qe,c(w(k)(o.value.price)),1),s("span",Ce,c(w(k)(o.value.discountedPrice||o.value.price)),1)],64)):(b(),E(z,{key:1},[P(c(w(k)(o.value.price)),1)],64))]),i(q,{color:T.value,"text-color":$.value,label:e.$t("singleProduct.addToCart"),class:"q-px-md full-width",onClick:t[1]||(t[1]=ue(a=>D(o.value),["stop"]))},null,8,["color","text-color","label"])]),_:1})])],2)]),s("div",Te,[i(q,{color:T.value,"text-color":$.value,label:e.$t("singleProduct.backToProducts"),onClick:G},null,8,["color","text-color","label"])]),i(pe,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=a=>g.value=a),maximized:""},{default:p(()=>[i(me,{class:"q-pa-md",style:{"max-width":"90vw","max-height":"90vh",overflow:"hidden"}},{default:p(()=>[s("div",$e,[s("div",Ie,c(o.value.name),1),i(q,{flat:"",dense:"",round:"",icon:"close",onClick:t[2]||(t[2]=a=>g.value=!1)})]),i(V,{src:I(o.value.image),alt:C.value,class:B(["zoomable-image tw-cursor-pointer",{"zoom-in":l.value,"zoom-out":!l.value}]),style:ve([{"max-width":"100%","max-height":"100%"},Z.value]),fit:"contain",onClick:Q,onMouseenter:O,onMousemove:H,onMouseleave:W,onTouchstart:R,onTouchmove:x,onTouchend:_},null,8,["src","alt","class","style"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Xe as default};
